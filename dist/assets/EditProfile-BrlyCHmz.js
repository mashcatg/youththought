import{r as i,j as e}from"./index-BAH94AsE.js";import{T as _,S as v,B as y}from"./BottomNavbar-CoKUF_2U.js";import"./logo-lBSZb2lU.js";const F=()=>{const[o,l]=i.useState({username:"",designation:"",bio:"",profilePic:""}),[m,h]=i.useState(null),[w,c]=i.useState(""),[t,f]=i.useState({oldPassword:"",newPassword:"",confirmNewPassword:""});i.useEffect(()=>{(async()=>{try{const a=await(await fetch("https://www.youthsthought.com/backend/get_profile_data.php",{method:"GET",credentials:"include"})).json();a.status==="success"?(l({username:a.name,designation:a.designation,bio:a.bio,profilePic:a.profile_pic}),c("")):console.error(a.message)}catch(s){console.error("Error fetching profile data:",s)}})()},[]);const d=r=>{const{name:s,value:a}=r.target;l({...o,[s]:a})},u=r=>{const s=URL.createObjectURL(r);c(s),h(r)},g=r=>{const s=r.target.files[0];s&&u(s)},P=r=>{r.preventDefault(),r.stopPropagation()},b=r=>{r.preventDefault(),r.stopPropagation();const s=r.dataTransfer.files[0];s&&u(s)},N=async r=>{r.preventDefault();const s=new FormData;s.append("username",o.username),s.append("designation",o.designation),s.append("bio",o.bio),m&&s.append("profilePic",m),s.append("existingProfilePic",o.profilePic);try{const a=await fetch("https://www.youthsthought.com/backend/update_profile.php",{method:"POST",body:s,credentials:"include"}),n=await a.json();n.success?alert(n.success):n.error&&alert(n.error),a.ok?console.log("Profile updated:",n):(console.error("Server responded with status:",a.status),console.error("Server error:",n.error))}catch(a){console.error("Error updating profile:",a)}},p=r=>{const{name:s,value:a}=r.target;f({...t,[s]:a})},x=async r=>{if(r.preventDefault(),t.newPassword!==t.confirmNewPassword){alert("New password and confirmation do not match!");return}console.log("Password change request:",t),f({oldPassword:"",newPassword:"",confirmNewPassword:""});try{const s=await fetch("https://www.youthsthought.com/backend/update_password.php",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}),a=await s.json();a.success?alert(a.success):a.error&&alert(a.error),s.ok?console.log("Password updated:",a):(console.error("Server responded with status:",s.status),console.error("Server error:",a.error))}catch(s){console.error("Error updating password:",s)}},j=()=>{l({username:o.username,designation:o.designation,bio:o.bio,profilePic:o.profilePic}),c("")};return e.jsxs("div",{className:"edit-profile-page",children:[e.jsx(_,{}),e.jsxs("div",{className:"main-container",children:[e.jsx(v,{}),e.jsxs("div",{className:"content",children:[e.jsxs("form",{onSubmit:N,className:"edit-profile-form",children:[e.jsx("div",{className:"form__group",children:e.jsxs("div",{className:"profile-pic-wrapper",onDragOver:P,onDrop:b,children:[e.jsx("img",{src:w||(o.profilePic?"../../public/dp/"+o.profilePic:"../../public/dp/default.png"),alt:"Profile Avatar",className:"profile-pic",style:{width:"100px",height:"100px",objectFit:"cover"}}),e.jsx("label",{htmlFor:"profilePic",className:"upload-btn",children:"Upload New Picture"}),e.jsx("input",{type:"file",id:"profilePic",accept:"image/*",className:"profile-pic-input",onChange:g})]})}),e.jsxs("div",{className:"form__group field",children:[e.jsx("input",{type:"text",className:"form__field",placeholder:"Name",name:"username",id:"name",value:o.username,onChange:d,required:!0}),e.jsx("label",{htmlFor:"name",className:"form__label",children:"Name"})]}),e.jsxs("div",{className:"form__group field",children:[e.jsx("input",{type:"text",className:"form__field",placeholder:"Designation",name:"designation",id:"designation",value:o.designation,onChange:d,required:!0}),e.jsx("label",{htmlFor:"designation",className:"form__label",children:"Designation"})]}),e.jsxs("div",{className:"form__group",children:[e.jsx("label",{htmlFor:"bio",className:"form__label",children:"Bio"}),e.jsx("textarea",{id:"bio",name:"bio",className:"form__field",value:o.bio,onChange:d})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"save-btn",children:"Save Changes"}),e.jsx("button",{type:"button",className:"cancel-btn",onClick:j,children:"Cancel"})]})]}),e.jsxs("form",{onSubmit:x,className:"change-password-form",children:[e.jsx("h2",{children:"Change Password"}),e.jsxs("div",{className:"form__group field",children:[e.jsx("input",{type:"password",className:"form__field",placeholder:"Old Password",name:"oldPassword",id:"oldPassword",value:t.oldPassword,onChange:p,required:!0}),e.jsx("label",{htmlFor:"oldPassword",className:"form__label",children:"Old Password"})]}),e.jsxs("div",{className:"form__group field",children:[e.jsx("input",{type:"password",className:"form__field",placeholder:"New Password",name:"newPassword",id:"newPassword",value:t.newPassword,onChange:p,required:!0}),e.jsx("label",{htmlFor:"newPassword",className:"form__label",children:"New Password"})]}),e.jsxs("div",{className:"form__group field",children:[e.jsx("input",{type:"password",className:"form__field",placeholder:"Confirm New Password",name:"confirmNewPassword",id:"confirmNewPassword",value:t.confirmNewPassword,onChange:p,required:!0}),e.jsx("label",{htmlFor:"confirmNewPassword",className:"form__label",children:"Confirm New Password"})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"change-password-btn",children:"Change Password"})})]})]})]}),e.jsx(y,{})]})};export{F as default};
