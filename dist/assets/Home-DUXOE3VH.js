import{r as n,j as e,N as j}from"./index-BAH94AsE.js";import{L as x,T as N,S as w,B as b}from"./BottomNavbar-CoKUF_2U.js";import{P as g}from"./Post-SE6ZSh97.js";import"./logo-lBSZb2lU.js";import"./TileLayer-Ct-sMkY9.js";const v=()=>{const[o,p]=n.useState([]),[f,u]=n.useState(0),[c,l]=n.useState(!1),[r,m]=n.useState(!0),i=n.useRef(null);n.useEffect(()=>{d(0)},[]);const d=n.useCallback((s=0)=>{if(c||!r)return;l(!0);const t=new URLSearchParams({offset:s});fetch("http://localhost/youthsthought/backend/fetch_posts.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()}).then(a=>a.json()).then(a=>{a.length===0?m(!1):(p(h=>[...h,...a]),u(h=>h+5)),l(!1)}).catch(a=>{console.error("Error fetching posts: ",a),l(!1)})},[c,r]);return n.useEffect(()=>{const s=new IntersectionObserver(t=>{t[0].isIntersecting&&r&&d(f)},{threshold:1});return i.current&&s.observe(i.current),()=>{i.current&&s.unobserve(i.current)}},[d,f,r]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"newsfeed-container",children:[e.jsx("div",{className:"newsfeed left",children:o.filter((s,t)=>t%2!==0).map(s=>e.jsx(g,{post:s},s.post_id))}),e.jsx("div",{className:"newsfeed right",children:o.filter((s,t)=>t%2===0).map(s=>e.jsx(g,{post:s},s.post_id))})]}),e.jsx("div",{className:"newsfeed mobile",children:o.map(s=>e.jsx(g,{post:s},s.post_id))}),e.jsx("div",{ref:i,className:"loader",children:c})]})},S=()=>{const[o,p]=n.useState(null),[f,u]=n.useState(!0),[c,l]=n.useState([]),[r,m]=n.useState(0),i=()=>{window.location.href="http://localhost/youthsthought/backend/logout.php"};n.useEffect(()=>{(async()=>{try{const t=await fetch("http://localhost/youthsthought/backend/get_profile_data.php",{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const a=await t.json();p(a),u(!1)}catch(t){console.error("Error fetching user data",t),u(!1)}})()},[]),n.useEffect(()=>{(async()=>{try{const t=await fetch(`http://localhost/youthsthought/backend/fetch_users.php?offset=${r}`);if(!t.ok)throw new Error("Failed to fetch users");const a=await t.json();console.log("Fetched users:",a),l(h=>[...h,...a])}catch(t){console.error("Error fetching users:",t)}})()},[r]);const d=()=>{m(s=>s+10)};return f?e.jsx(x,{}):e.jsxs("div",{className:"user-profile-column",children:[o!=null&&o.loggedIn?e.jsxs("div",{className:"profile",children:[e.jsx("img",{src:o.profile_pic?`../../public/dp/${o.profile_pic}`:"../../public/dp/default.png",alt:o.name,className:"user-pic"}),e.jsxs("div",{className:"details",children:[e.jsx("span",{className:"name",children:o.name}),e.jsx("span",{className:"designation",children:o.designation}),e.jsxs("div",{className:"buttons",children:[e.jsx(j,{to:"/edit-profile",children:e.jsx("button",{className:"edit-profile-btn",children:"Edit Profile"})}),e.jsx("button",{className:"logout-btn",onClick:i,children:"Logout"})]})]})]}):e.jsxs("div",{className:"auth-buttons",children:[e.jsx("button",{onClick:()=>window.location.href="/login",children:"Login"}),e.jsx("button",{onClick:()=>window.location.href="/signup",children:"Sign Up"})]}),e.jsxs("div",{className:"suggestions",children:[e.jsx("div",{className:"divider",children:e.jsx("span",{children:"Rising Youths"})}),e.jsx("ul",{children:c.map(s=>e.jsx(j,{to:`/profile/${s.user_id}`,className:"menu-item",children:e.jsxs("li",{children:[" ",e.jsx("img",{src:`../../public/dp/${s.profile_picture}`,alt:s.name,className:"suggested-pic"}),e.jsxs("div",{className:"suggested-details",children:[e.jsx("span",{className:"suggested-name",children:s.name}),e.jsxs("span",{className:"suggested-designation",children:[s.designation||"No Designation"," "]})]})]},s.user_id)}))}),e.jsx("div",{className:"view-more-btn-container",children:e.jsx("button",{className:"view-more-btn",onClick:d,children:"View More"})})]})]})};function U(){return e.jsxs("div",{className:"app",children:[e.jsx(N,{}),e.jsxs("div",{className:"main-container",children:[e.jsx(w,{}),e.jsxs("div",{className:"content",children:[e.jsx(v,{}),e.jsx(S,{})]})]}),e.jsx(b,{})]})}export{U as default};
