import{r,a as N,j as s,N as w}from"./index-BAH94AsE.js";import{P as b}from"./Post-SE6ZSh97.js";import{L as y,T as S,S as k,B as E}from"./BottomNavbar-CoKUF_2U.js";import"./TileLayer-Ct-sMkY9.js";import"./logo-lBSZb2lU.js";function D(){const[i,p]=r.useState([]),[d,f]=r.useState([]),[x,h]=r.useState(!0),[u,m]=r.useState(null),[c,j]=r.useState(1),{keywords:l}=N(),n=r.useRef(null),g=async(e=!1)=>{h(!0),m(null);try{const t=await fetch(`https://www.youthsthought.com/backend/get_search_users.php?keywords=${l}&page=${c}`);if(!t.ok)throw new Error("Failed to fetch users");const o=await t.json();if(c===1){const a=await fetch(`https://www.youthsthought.com/backend/get_search_posts.php?keywords=${l}`);if(!a.ok)throw new Error("Failed to fetch posts");const v=await a.json();f(v)}p(a=>e?[...a,...o]:o)}catch(t){m(t.message)}finally{h(!1)}};return r.useEffect(()=>{g()},[l,c]),r.useEffect(()=>{const e={root:null,rootMargin:"0px",threshold:1},t=new IntersectionObserver(o=>{o[0].isIntersecting&&j(a=>a+1)},e);return n.current&&t.observe(n.current),()=>{n.current&&t.unobserve(n.current)}},[]),x&&i.length===0?s.jsx(y,{}):u?s.jsxs("div",{children:["Error: ",u]}):s.jsxs("div",{className:"profile-page",children:[s.jsx(S,{}),s.jsxs("div",{className:"main-container",children:[s.jsx(k,{}),s.jsx("div",{className:"content",children:s.jsxs("div",{className:"search-results",children:[s.jsx("h2",{children:"Users"}),s.jsxs("div",{className:"user-profiles-horizontal",children:[i.length===0?s.jsx("div",{className:"no-users-found",children:"No users found"}):i.map((e,t)=>s.jsx(w,{to:`/profile/${e.user_id}`,className:"menu-item",children:s.jsxs("div",{className:"user-container",children:[s.jsx("div",{className:"user-image",children:s.jsx("img",{src:`../../public/dp/${e.profile_picture}`,alt:e.name})}),s.jsxs("div",{className:"details",children:[s.jsx("div",{className:"user-name",children:e.name}),s.jsx("div",{className:"user-designation",children:e.designation}),s.jsx("button",{className:"message-btn",children:"Message"})]})]})})),s.jsx("div",{ref:n,style:{visibility:"hidden",height:"1px"}})]}),s.jsxs("div",{className:"results",children:[s.jsx("h2",{children:"Posts"}),s.jsx("div",{className:"posts-grid",children:d.length===0?s.jsx("div",{className:"no-posts-found",children:"No posts found"}):d.map(e=>s.jsx(b,{post:e},e.post_id))})]})]})})]}),s.jsx(E,{})]})}export{D as default};
